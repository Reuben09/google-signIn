<html lang="en">
  <head>
    <meta name="google-signin-scope" content="profile email">
    <meta name="google-signin-client_id" content="1002294605425-1qoa9kbsesa8428ic050hdp2igdisg42.apps.googleusercontent.com">
    
    <script src="https://accounts.google.com/gsi/client" async></script>

  </head>
  <body>

    <script>
      var isUserSignedIn = true; // Change this based on your actual logic

// Get the element by its ID
var userStatusElement = document.getElementById('userStatus');

// Change the text based on the user's sign-in status
if (isUserSignedIn) {
  userStatusElement.innerText = "Signed in as:";
} else {
  userStatusElement.innerText = "Sign in with:";
}

      function handleCredentialResponse(response) {
        console.log("Google Sign-In response:", response);
    
        // Assuming you have some logic to determine if sign-in is successful
        var isSignInSuccessful = true;
    
        if (response.credential) {
          console.log("Sign-in successful. Displaying the protected div.");

          // Store user's credentials in sessionStorage
          sessionStorage.setItem("googleSignInToken", JSON.stringify(response.credential));
           
          //document.getElementById("google").style.display = "none";
          // Show the protected div
          document.getElementById("protectedDiv").style.display = "block";
          //window.location.href = "restricted-page.html";
        } else {
          console.log("Sign-in failed or incomplete. Handle accordingly.");
          // Additional logic for handling failed sign-in
        }
      }

      function handleStoredCredentials() {
        // Check if there are stored credentials in sessionStorage
        var storedToken = sessionStorage.getItem("googleSignInToken");
        console.log("Stored Token:", storedToken);

        if (storedToken) {
          // Handle the stored token (e.g., consider the user as signed in)
          document.getElementById("google").style.display = "none";
          console.log("User is signed in.");
          document.getElementById("protectedDiv").style.display = "block";

          // Redirect to the restricted page
          //console.log("Redirecting...");
          //window.location.href = "restricted-page.html"; // Update with your actual URL
        } else {
          // No stored token, load Google Sign-In library
          loadGoogleSignIn();
        }
      }

      function loadGoogleSignIn() {
        // Explicitly load the Google Sign-In library
        google.accounts.id.initialize({
          client_id: "1002294605425-1qoa9kbsesa8428ic050hdp2igdisg42.apps.googleusercontent.com",
          callback: handleCredentialResponse
        });

        google.accounts.id.renderButton(
          document.getElementById("buttonDiv"),
          { theme: "outline", size: "large" }  // customization attributes
        );

        google.accounts.id.prompt(); // also display the One Tap dialog
      }

      // Check for stored credentials on page load
      window.onload = function() {
        handleStoredCredentials();
      };
    </script>

<div id="google">
    <div id="g_id_onload"
      data-client_id="1002294605425-1qoa9kbsesa8428ic050hdp2igdisg42.apps.googleusercontent.com"
      data-context="signup"
      data-ux_mode="popup"
      data-login_uri="" 
      data-callback="handleCredentialResponse"
      data-nonce=""
      data-itp_support="true">
    </div>
<!--restricted-page.html-->
<div id="userStatus" class="g_id_signup"
data-type="standard"
data-shape="rectangular"
data-theme="outline"
data-size="large"
data-text="signup_with"
data-logo_alignment="left">
</div>
 <p>Sign In</p>
</div>
    <!-- Protected div initially hidden -->
    <div id="protectedDiv" style="display: none;">
      <!-- Content of your protected div goes here -->
      <h1>This is the protected content!</h1>
    </div>

    <!-- YOUR WEBSITE CODE -->

  </body>
</html>
